<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Cleaning up the Success Callback</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Ajax with jQuery</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. The jQuery Library &amp; Ajax.html">01. The jQuery Library &amp; Ajax</a>
    </li>
    <li class="">
      <a href="02. jQuery&#x27;s &#x60;ajax()&#x60; Method.html">02. jQuery&#x27;s &#x60;ajax()&#x60; Method</a>
    </li>
    <li class="">
      <a href="03. Handling The Returned Data.html">03. Handling The Returned Data</a>
    </li>
    <li class="">
      <a href="04. Cleaning up the Success Callback.html">04. Cleaning up the Success Callback</a>
    </li>
    <li class="">
      <a href="05. Code Walkthrough.html">05. Code Walkthrough</a>
    </li>
    <li class="">
      <a href="06. Peek inside $.ajax().html">06. Peek inside $.ajax()</a>
    </li>
    <li class="">
      <a href="07. Review the Call Stack.html">07. Review the Call Stack</a>
    </li>
    <li class="">
      <a href="08. Walkthrough of .ajaxTransport.html">08. Walkthrough of .ajaxTransport</a>
    </li>
    <li class="">
      <a href="09. jQuery&#x27;s Other Async Methods.html">09. jQuery&#x27;s Other Async Methods</a>
    </li>
    <li class="">
      <a href="10. Async with jQuery Outro.html">10. Async with jQuery Outro</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">04. Cleaning up the Success Callback</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3></h3>
  <div>
  <p>Content isn't getting added to the page jQuery detects the response and if it's JSON, it will automatically convert it to JavaScript for us. How awesome is that! So we only need to make a few tweaks to the existing code. Here's what it currently is:</p>
<pre><code class="js language-js">function addImage() {
    const data = JSON.parse(this.responseText);
    const firstImage = data.results[0];

    responseContainer.insertAdjacentHTML('afterbegin', `&lt;figure&gt;
            &lt;img src="${firstImage.urls.small}" alt="${searchedForText}"&gt;
            &lt;figcaption&gt;${searchedForText} by ${firstImage.user.name}&lt;/figcaption&gt;
        &lt;/figure&gt;`
    );
}</code></pre>
<p>We just need to change the first three lines:</p>
<pre><code class="js language-js">function addImage(images) {
    const firstImage = images.results[0];

    responseContainer.insertAdjacentHTML('afterbegin', `&lt;figure&gt;
            &lt;img src="${firstImage.urls.small}" alt="${searchedForText}"&gt;
            &lt;figcaption&gt;${searchedForText} by ${firstImage.user.name}&lt;/figcaption&gt;
        &lt;/figure&gt;`
    );
}</code></pre>
<h2 id="what-changed">What changed</h2>
<ul>
<li>the function now has one parameter <code>images</code></li>
<li>this parameter has already been converted from JSON to a JavaScript object, so * the line that had <code>JSON.parse()</code> is no longer needed.</li>
<li>the <code>firstImage</code> variable is set to the <code>images.results</code> first item</li>
</ul>
<p>The code that adds the HTML to the response container hasn't changed at all!</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Replace Nytimes Xhr With $.Ajax()</p></h3>
  <div>
  <div>
    <h4>Task Description:</h4>
    <p>Now that we've walked through converting one request from using XHR to jQuery's <code>.ajax()</code> method, why don't you give it a shot on your own and convert the second request!</p>
<p>Make sure to use the existing code as an example. If you get stuck, check out the documentation page.</p>
<p>When you're successfully converted the code to use jQuery's <code>.ajax()</code> method and fixed the callback function so it adds the data to the page, check the checkbox to continue.</p>
  </div>

  <form>
    <fieldset>
      <legend>Task List:</legend>

      <div>
        <input type="checkbox" id="ce8f1ad8-b942-41c6-b217-53fa1858ecda--0">
        <label for="ce8f1ad8-b942-41c6-b217-53fa1858ecda--0"><p>I've successfully converted the code!</p></label>
      </div>
    </fieldset>
  </form>

  <div>
    <h4>Task Feedback:</h4>


    <p>Great!</p>
  </div>
</div>


</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="05. Code Walkthrough.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('04. Cleaning up the Success Callback')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
