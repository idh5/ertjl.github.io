WEBVTT
Kind: captions
Language: zh-CN

00:00:00.000 --> 00:00:03.470
我们已经创建 action creator

00:00:03.470 --> 00:00:09.550
下一步是创建处理这些 action 的 Reducer

00:00:09.550 --> 00:00:13.510
新建一个叫做 reducers 的文件夹

00:00:13.509 --> 00:00:16.250
在该文件夹中

00:00:16.250 --> 00:00:18.530
新建一个文件 叫做 index.js

00:00:18.530 --> 00:00:21.080
然后我们将

00:00:21.079 --> 00:00:23.914
导入这两个常量

00:00:23.914 --> 00:00:26.674
导入 RECEIVE_ENTRIES

00:00:26.675 --> 00:00:29.324
以及 ADD_ENTRIES

00:00:29.324 --> 00:00:32.719
二者都来自 /actions

00:00:32.719 --> 00:00:38.719
现在创建一个 entries reducer

00:00:38.719 --> 00:00:41.689
它将传入一个 state 我们将默认 state 设为空的对象

00:00:41.689 --> 00:00:45.424
然后传入一个 action

00:00:45.424 --> 00:00:49.849
和平常一样 在这里创建一个 switch 语句

00:00:49.850 --> 00:00:55.899
对 action.type 进行切换 然后设定几个不同的 case

00:00:55.899 --> 00:00:58.969
第一个是 RECEIVE_ENTRIES

00:00:58.969 --> 00:01:01.198
第二个是 ADD_ENTRY

00:01:01.198 --> 00:01:04.760
最后一个是默认 case

00:01:04.760 --> 00:01:09.670
它将直接返回 state

00:01:09.670 --> 00:01:12.850
先导出这个 以防我忘记了

00:01:12.849 --> 00:01:17.574
每当符合 RECEIVE_ENTRIES case 时

00:01:17.575 --> 00:01:20.493
即每当 action.type 是 RECEIVE_ENTRIES 时

00:01:20.492 --> 00:01:23.359
我们希望 state 保持不变

00:01:23.359 --> 00:01:29.495
并且在 state 上合并 action.entries

00:01:29.495 --> 00:01:31.050
action.entries

00:01:31.049 --> 00:01:34.593
位于这里

00:01:34.593 --> 00:01:35.840
它将表示一个对象

00:01:35.840 --> 00:01:38.990
该对象的键

00:01:38.989 --> 00:01:43.784
代表的是具体的某一天 值是当天的具体指标

00:01:43.784 --> 00:01:48.799
我们想将整个对象合并到现有 state 上

00:01:48.799 --> 00:01:51.679
当这个函数运行时 将为空的对象

00:01:51.680 --> 00:01:57.410
接着 如果符合 ADD_ENTRY case

00:01:57.409 --> 00:02:02.329
则返回现有的 state 并且和之前一样

00:02:02.329 --> 00:02:05.929
获取 action.entry entry 现在将是当天的崭新条目

00:02:05.930 --> 00:02:09.900
并将其合并到 state 上

00:02:09.900 --> 00:02:13.969
我们只有这里的一个 Reducer 并且始终只有一个

00:02:13.969 --> 00:02:17.270
state 将是一个很庞大的对象 并且始终是这样

00:02:17.270 --> 00:02:20.375
该对象上的每个键

00:02:20.375 --> 00:02:23.479
都代表特定的某一天

00:02:23.479 --> 00:02:26.924
每个值代表当天的具体指标

00:02:26.925 --> 00:02:29.900
因此在 RECEIVE_ENTRIES 和 ADD_ENTRY case 中

00:02:29.900 --> 00:02:34.295
我们可以获取该特定 action 上的信息

00:02:34.294 --> 00:02:39.000
并将其合并到 state 上 因为 state 是针对所有日期的庞大对象

