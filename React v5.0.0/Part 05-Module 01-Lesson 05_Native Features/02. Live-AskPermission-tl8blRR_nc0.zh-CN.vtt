WEBVTT
Kind: captions
Language: zh-CN

00:00:00.000 --> 00:00:03.390
这将是我们一直期待的视频内容

00:00:03.390 --> 00:00:07.290
我们将学习如何向用户请求

00:00:07.290 --> 00:00:11.675
位置信息查看和跟踪权限

00:00:11.675 --> 00:00:14.655
我们转到 askPermission 中

00:00:14.654 --> 00:00:16.109
补充完整所需的代码

00:00:16.109 --> 00:00:21.804
输入 Permissions.askAsync

00:00:21.804 --> 00:00:24.660
这里是 askAsync 而不是 getAsync

00:00:24.660 --> 00:00:26.460
我们要请求的权限

00:00:26.460 --> 00:00:31.765
和第 15 行的一样 即 permissions.LOCATION

00:00:31.765 --> 00:00:34.980
然后就像在 componentDidMount 中一样

00:00:34.979 --> 00:00:38.909
我们将获得一个 status

00:00:38.909 --> 00:00:44.774
如果 status 为 granted

00:00:44.774 --> 00:00:50.954
则 return this.setLocation

00:00:50.954 --> 00:00:53.064
如果未授予权限

00:00:53.064 --> 00:00:55.829
则像之前一样

00:00:55.829 --> 00:01:01.414
设置 status 使状态知道所发生的情况

00:01:01.414 --> 00:01:03.299
如果出现任何错误

00:01:03.299 --> 00:01:07.750
确保记录错误 以便知晓这些错误

00:01:07.750 --> 00:01:15.030
输入 console.warn 输出消息“error asking Location permission:”

00:01:15.030 --> 00:01:18.775
然后输出错误日志

00:01:18.775 --> 00:01:20.850
看起来不错 发现这里有个拼写错误

00:01:20.849 --> 00:01:23.184
这里应该是 askAsync

00:01:23.185 --> 00:01:26.185
你之前可能已经发现了 明显我没有发现

00:01:26.185 --> 00:01:28.320
我们转到应用界面

00:01:28.319 --> 00:01:29.789
看看实际运行效果

00:01:29.790 --> 00:01:30.890
转到 Live

00:01:30.890 --> 00:01:34.420
系统提示“You need to enable location services for this app.”

00:01:34.420 --> 00:01:36.375
当我们点击 Enable 时

00:01:36.375 --> 00:01:40.000
弹出了一条消息

00:01:40.000 --> 00:01:43.935
提示 expo 想要访问你的位置信息

00:01:43.935 --> 00:01:46.695
允许还是拒绝？

00:01:46.694 --> 00:01:49.559
我将点击“Allow”

00:01:49.560 --> 00:01:52.780
然后出现了一些信息

00:01:52.780 --> 00:01:54.659
但这些信息是静态信息

00:01:54.659 --> 00:01:57.394
并非从手机中获取的信息

00:01:57.394 --> 00:02:02.039
我将快速更新下 render 方法

00:02:02.040 --> 00:02:05.070
这里依然包含 direction 和 coords

00:02:05.069 --> 00:02:09.719
将这里的 North

00:02:09.719 --> 00:02:13.080
改为 direction

00:02:13.080 --> 00:02:16.890
这里不再直接显示 200

00:02:16.889 --> 00:02:24.524
而是改为 Math.round(coords.altitude)

00:02:24.525 --> 00:02:29.385
然后乘以 3.2808

00:02:29.384 --> 00:02:35.759
以便转换为英尺

00:02:35.759 --> 00:02:39.024
每小时英里数也一样

00:02:39.025 --> 00:02:46.920
输入 coords.speed * 2.2369

00:02:46.919 --> 00:02:49.709
我觉得我的物理知识应该没记错

00:02:49.710 --> 00:02:53.875
然后输入 .toFixed(1)

00:02:53.875 --> 00:02:57.115
将会转换为英里/小时

00:02:57.115 --> 00:02:59.335
看看是否可行

00:02:59.335 --> 00:03:01.349
你会发现

00:03:01.349 --> 00:03:04.835
我的模拟器在不断更改 MPH 值

00:03:04.835 --> 00:03:10.230
转到 Hardware 然后转到 Debug

00:03:10.229 --> 00:03:13.965
转到 Location 在这里可以选择位置信息模式

00:03:13.965 --> 00:03:18.710
我的是骑行状态 因为速度大约为 60 英里/小时

00:03:18.710 --> 00:03:21.165
如果选择 Freeway Drive

00:03:21.164 --> 00:03:26.500
我的速度最终会增大

00:03:26.500 --> 00:03:28.780
另一个比较酷的地方是

00:03:28.780 --> 00:03:31.090
还会更改方向

